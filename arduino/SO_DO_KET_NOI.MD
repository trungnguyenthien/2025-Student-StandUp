### **Bแบฃng kแบฟt nแปi cรกc module vแปi NodeMCU (ESP8266)**

| **Thiแบฟt bแป**            | **Chรขn trรชn Module** | **Chรขn trรชn NodeMCU (ESP8266)** | **Giแบฃi thรญch chi tiแบฟt** |
|-------------------------|---------------------|--------------------------------|-------------------------|
| **Nguแปn 5V**            | VCC                 | VIN                            | Cแบฅp nguแปn 5V tแปซ NodeMCU cho DFPlayer Mini vร US-015. |
| **GND (Mass)**          | GND                 | GND                            | Nแปi tแบฅt cแบฃ GND chung ฤแป ฤแบฃm bแบฃo tรญn hiแปu แปn ฤแปnh. |
| **US-015 Trig**         | TRIG                | D5 (GPIO14)                    | Chรขn kรญch hoแบกt phรกt xung siรชu รขm. |
| **US-015 Echo**         | ECHO                | D6 (GPIO12) _(qua chia รกp 5Vโ3.3V)_ | Echo trแบฃ vแป tรญn hiแปu 5V, cแบงn chia รกp xuแปng 3.3V ฤแป bแบฃo vแป NodeMCU. |
| **DFPlayer Mini TX**     | TX                  | D7 (GPIO13) _(RX cแปงa NodeMCU)_  | DFPlayer gแปญi dแปฏ liแปu ฤแบฟn NodeMCU, nhแบญn lแปnh phรกt nhแบกc. |
| **DFPlayer Mini RX**     | RX                  | D8 (GPIO15) _(TX cแปงa NodeMCU)_  | NodeMCU gแปญi lแปnh ฤiแปu khiแปn ฤแบฟn DFPlayer. |
| **Thแบป nhแป TF (MicroSD)** | Gแบฏn vรo DFPlayer    | -                              | Chแปฉa file nhแบกc dแบกng `.mp3`, tแป chแปฉc theo thฦฐ mแปฅc `/01/001.mp3`. |

---

### **Lฦฐu รฝ quan trแปng**
1. **Chia รกp ฤiแปn รกp cho US-015 Echo (5V โ 3.3V)**  
   - Echo cแปงa US-015 trแบฃ vแป tรญn hiแปu **5V**, nhฦฐng **NodeMCU chแป chแบฅp nhแบญn tแปi ฤa 3.3V**.  
   - Dรนng **mแบกch chia รกp ฤiแปn trแป**:
     - **R1 = 1kฮฉ** (GND).
     - **R2 = 2kฮฉ** (kแบฟt nแปi vแปi Echo).
   - Cรดng thแปฉc:  
     $
     V_{out} = V_{in} \times \frac{R1}{R1 + R2}
     $
     $
     V_{out} = 5V \times \frac{1kฮฉ}{1kฮฉ + 2kฮฉ} = 3.3V
     $

2. **Giao tiแบฟp DFPlayer Mini vแปi NodeMCU**
   - NodeMCU **giao tiแบฟp vแปi DFPlayer Mini bแบฑng UART (serial)**.
   - **ESP8266SoftwareSerial** ฤฦฐแปฃc sแปญ dแปฅng thay vรฌ `SoftwareSerial` ฤแป ฤแบฃm bแบฃo แปn ฤแปnh.

3. **Cแบฅp nguแปn 5V**
   - **NodeMCU cรณ thแป cแบฅp 5V tแปซ chรขn VIN**, ฤแปง ฤแป cแบฅp cho cแบฃ **US-015 vร DFPlayer Mini**.

---

### **Tรณm lแบกi**
โ **Chรขn Echo cแปงa US-015 cแบงn chia รกp trฦฐแปc khi vรo NodeMCU**.  
โ **DFPlayer Mini giao tiแบฟp vแปi NodeMCU bแบฑng `ESP8266SoftwareSerial` trรชn chรขn D7 vร D8**.  
โ **Tแบฅt cแบฃ thiแบฟt bแป ฤแปu dรนng chung GND ฤแป ฤแบฃm bแบฃo tรญn hiแปu แปn ฤแปnh**.  

๐ **Bแบกn cรณ muแปn thรชm kแบฟt nแปi vแปi WiFi ฤแป ฤiแปu khiแปn tแปซ xa khรดng?** ๐


----------

### **Hฦฐแปng dแบซn chia รกp tแปซ 5V xuแปng 3.3V bแบฑng 2 ฤiแปn trแป**  

Mแบกch chia รกp lร cรกch ฤฦกn giแบฃn vร hiแปu quแบฃ ฤแป giแบฃm ฤiแปn รกp **tแปซ 5V xuแปng 3.3V**, giรบp bแบฃo vแป **ESP32 hoแบทc cรกc vi ฤiแปu khiแปn chแบกy mแปฉc logic 3.3V**.

---

## **1๏ธโฃ Nguyรชn lรฝ hoแบกt ฤแปng cแปงa mแบกch chia รกp**  
Mแบกch chia รกp hoแบกt ฤแปng theo nguyรชn lรฝ phรขn รกp ฤiแปn trแป:

$
V_{out} = V_{in} \times \frac{R1}{R1 + R2}
$

Trong ฤรณ:
- **\(V_{in}\)**: ฤiแปn รกp ฤแบงu vรo (5V tแปซ US-015 Echo hoแบทc thiแบฟt bแป khรกc).  
- **\(V_{out}\)**: ฤiแปn รกp ฤแบงu ra (cแบงn hแบก xuแปng 3.3V cho ESP32).  
- **\(R1\)**: ฤiแปn trแป nแปi giแปฏa tรญn hiแปu ฤแบงu vรo vร GND.  
- **\(R2\)**: ฤiแปn trแป nแปi giแปฏa tรญn hiแปu ฤแบงu vรo vร ฤแบงu ra cแบงn sแปญ dแปฅng.  

---

## **2๏ธโฃ Sฦก ฤแป mแบกch chia รกp**
```
           5V (Echo tแปซ US-015)
                     โ
                     โโโโ [2kฮฉ] โโโ GPIO ESP32 (3.3V)
                     โ
                   [1kฮฉ]
                     โ
                    GND
```

---

## **3๏ธโฃ Chแปn giรก trแป ฤiแปn trแป phรน hแปฃp**
Dรนng cรดng thแปฉc:

$
V_{out} = V_{in} \times \frac{R1}{R1 + R2}
$

- **Mแปฅc tiรชu:** Hแบก tแปซ **5V xuแปng 3.3V**.  
- **Giแบฃ sแปญ chแปn \(R1 = 1kฮฉ\), ta tรญnh \(R2\):**  

$
3.3V = 5V \times \frac{1kฮฉ}{1kฮฉ + R2}
$

$
R2 = \frac{1kฮฉ \times 5V}{3.3V} - 1kฮฉ = 2kฮฉ
$

โ **Cแบทp ฤiแปn trแป phแป biแบฟn**:  
- **\(R1 = 1kฮฉ\), \(R2 = 2kฮฉ\)** _(chรญnh xรกc 3.3V)_.  
- **Hoแบทc \(R1 = 10kฮฉ\), \(R2 = 20kฮฉ\)** _(cลฉng hoแบกt ฤแปng tแปt)_.  

---

## **4๏ธโฃ Cรกch lแบฏp mแบกch thแปฑc tแบฟ**
1. **Nแปi chรขn Echo (5V) cแปงa US-015 vแปi mแปt ฤแบงu cแปงa \(R2 = 2kฮฉ\)**.  
2. **Nแปi ฤแบงu kia cแปงa \(R2\) vแปi GPIO cแปงa ESP32 (3.3V)**.  
3. **Nแปi mแปt ฤแบงu \(R1 = 1kฮฉ\) vรo ฤiแปm giแปฏa \(R2\) vร ESP32 GPIO**.  
4. **Nแปi ฤแบงu cรฒn lแบกi cแปงa \(R1\) xuแปng GND**.  

---

## **5๏ธโฃ So sรกnh vแปi phฦฐฦกng phรกp khรกc**
| **Phฦฐฦกng phรกp**        | **Linh kiแปn cแบงn thiแบฟt**   | **ฦฏu ฤiแปm**                                | **Nhฦฐแปฃc ฤiแปm**                     |
|------------------------|------------------------|--------------------------------|--------------------------------|
| **Chia รกp bแบฑng 2 ฤiแปn trแป**  | 2 ฤiแปn trแป (1kฮฉ, 2kฮฉ)  | Dแป tรญnh toรกn, chรญnh xรกc, rแบป  | Khรดng phรน hแปฃp vแปi dรฒng cao |
| **Dรนng Diode Zener 3.3V**   | 1 Diode Zener + 1 ฤiแปn trแป 1kฮฉ | ฤฦกn giแบฃn hฦกn, khรดng tแปn nhiแปu linh kiแปn | ฤiแปn รกp cรณ thแป dao ฤแปng nhแบน |
| **Dรนng Logic Level Converter** | 1 Module | Chรญnh xรกc, phรน hแปฃp cho tแปc ฤแป cao | Cแบงn module riรชng, phแปฉc tแบกp hฦกn |

---

## **6๏ธโฃ Kแบฟt luแบญn**
โ **Nแบฟu bแบกn cแบงn giแบฃi phรกp ฤฦกn giแบฃn vร rแบป:** Dรนng **chia รกp ฤiแปn trแป** (1kฮฉ - 2kฮฉ).  
โ **Nแบฟu bแบกn cรณ sแบตn diode Zener:** Dรนng **Zener 3.3V + ฤiแปn trแป 1kฮฉ**.  
โ **Nแบฟu bแบกn cแบงn chuyแปn ฤแปi nhanh vแปi nhiแปu tรญn hiแปu:** Dรนng **Logic Level Converter**.  